\makeatletter
\def\manuscripts@{}

\newcommand{\manuscript}[1]{%
	\renewcommand{\do}[1]{\listgadd{\manuscripts@}{##1}}%
	\docsvlist{#1}%
}


\newcommandx*{\var}[4][4]{%
    \edtext{#1}{%
    	\ifstrempty{#4}{}{\lemma{#4}}%
    	\Afootnote{%
        	\ifstrempty{#2}{}{\del{#2}\ifstrempty{#3}{}{ ; }}%
        	\variantes{#3}%
    }}
}

\newcommand{\variantes}[1]{%
	\newif\iffirst%
	\firsttrue%
	\renewcommand{\do}[1]{\iffirst\firstfalse\else ; \fi\variante##1}%
	\docsvlist{#1}%
	}

\newcommand{\del}[1]{%
	\renewcommand{\do}[1]{%
		\ifinlist{##1}{\manuscripts@}%
		{##1}%
		{\eledmac@warning{Man. ##1 unknew, p.\the\page@num  ; l.\the\line@num}Man. ##1 inconnu}%
	}%
	\docsvlist{#1} \emph{omit}%
}

\newcommand{\variante}[2]{%
	\ifinlist{#1}{\manuscripts@}%
		{#1 #2}%
		{\eledmac@warning{Man. #1 unknew, p.\the\page@num  ; l.\the\line@num ; #2}Man. #1 #2}%
	}
\makeatother